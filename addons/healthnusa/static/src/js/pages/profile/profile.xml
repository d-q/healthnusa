<templates xml:space="preserve">
    <t t-name="healthnusa.Profile">
        <!-- Loading State -->
        <div t-if="state.loading" class="flex items-center justify-center h-64">
            <div class="text-center">
                <div class="animate-spin rounded-full h-12 w-12 border-b-2 border-custom-blue mx-auto"></div>
                <p class="mt-4 text-gray-600 dark:text-gray-400">Loading profile...</p>
            </div>
        </div>
        
        <!-- Main Content -->
        <div t-else="" class="flex gap-8">
            <!-- Left Column - User Profile -->
            <div class="w-1/3">
                <div class="bg-white dark:bg-gray-800 p-6 rounded-2xl shadow transition-colors duration-300 flex flex-col items-center">
                    <div class="relative mb-4">
                        <img alt="User profile picture" class="w-36 h-36 rounded-full object-cover" t-att-src="state.user.profileImage || '/web/static/img/user_menu_avatar.png'" />
                        <button t-on-click="changeProfileImage" class="absolute bottom-2 right-2 bg-custom-blue hover:bg-blue-600 text-white p-2 rounded-full shadow-lg transition duration-300">
                            <span class="material-icons text-sm">camera_alt</span>
                        </button>
                    </div>
                    <h2 class="text-xl font-bold text-gray-800 dark:text-gray-100" t-esc="state.user.name"/>
                    <p class="text-custom-blue mb-6" t-esc="state.user.role"/>
                    
                    <div class="w-full space-y-4 text-sm">
                        <div class="flex items-start">
                            <span class="material-icons text-gray-500 dark:text-gray-400 mr-3 mt-1">badge</span>
                            <div class="w-full">
                                <p class="text-gray-600 dark:text-gray-300 mb-2 font-medium">Employee ID</p>
                                <p class="font-bold text-gray-800 dark:text-gray-100" t-esc="state.user.employeeId"/>
                            </div>
                        </div>
                        <div class="flex items-start">
                            <span class="material-icons text-gray-500 dark:text-gray-400 mr-3 mt-1">domain</span>
                            <div class="w-full">
                                <p class="text-gray-600 dark:text-gray-300 mb-2 font-medium">Department</p>
                                <p class="font-bold text-gray-800 dark:text-gray-100" t-esc="state.user.department"/>
                            </div>
                        </div>
                        <div class="flex items-start pt-2">
                            <span class="material-icons text-gray-500 dark:text-gray-400 mr-3 mt-1">work_outline</span>
                            <div class="w-full">
                                <p class="text-gray-600 dark:text-gray-300 font-medium mb-1.5">Status</p>
                                <span class="bg-green-100 dark:bg-green-900 text-green-800 dark:text-green-200 text-xs font-medium px-2 py-1 rounded-full" t-esc="state.user.status"/>
                            </div>
                        </div>
                    </div>
                    
                    <div class="w-full mt-8 space-y-2">
                        <button t-on-click="enableEdit" t-if="!state.isEditing" class="w-full bg-custom-blue hover:bg-blue-600 text-white py-3 rounded-lg font-semibold transition duration-300 flex items-center justify-center space-x-2">
                            <span class="material-icons">edit</span>
                            <span>Edit Profile</span>
                        </button>
                        <button t-on-click="openPasswordModal" class="w-full bg-orange-500 hover:bg-orange-600 text-white py-3 rounded-lg font-semibold transition duration-300 flex items-center justify-center space-x-2">
                            <span class="material-icons">lock_reset</span>
                            <span>Change Password</span>
                        </button>
                    </div>
                </div>
            </div>

            <!-- Right Column - User Details -->
            <div class="w-2/3">
                <div class="bg-white dark:bg-gray-800 rounded-2xl shadow transition-colors duration-300">
                    <div class="p-6">
                        <!-- Header -->
                        <div class="flex justify-between items-center mb-6">
                            <h3 class="text-lg font-bold text-gray-800 dark:text-gray-100">Profile Details</h3>
                            <div t-if="state.isEditing" class="flex space-x-3">
                                <button t-on-click="saveProfile" class="bg-green-500 hover:bg-green-600 text-white px-4 py-2 rounded-lg font-medium transition duration-300 flex items-center space-x-2">
                                    <span class="material-icons text-sm">save</span>
                                    <span>Save</span>
                                </button>
                                <button t-on-click="cancelEdit" class="bg-gray-500 hover:bg-gray-600 text-white px-4 py-2 rounded-lg font-medium transition duration-300 flex items-center space-x-2">
                                    <span class="material-icons text-sm">cancel</span>
                                    <span>Cancel</span>
                                </button>
                            </div>
                        </div>

                        <!-- Personal Information -->
                        <div class="mb-8">
                            <h4 class="text-md font-semibold text-gray-800 dark:text-gray-100 mb-4">Personal Information</h4>
                            <div class="grid grid-cols-2 gap-6">
                                <div>
                                    <label class="block text-gray-500 dark:text-gray-400 mb-1 text-sm">Full Name</label>
                                    <input t-if="state.isEditing" t-model="state.editForm.name" type="text" class="w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-lg bg-white dark:bg-gray-700 text-gray-800 dark:text-gray-100 focus:ring-2 focus:ring-custom-blue focus:border-transparent" />
                                    <p t-else="" class="text-gray-800 dark:text-gray-100 font-medium" t-esc="state.user.name"/>
                                </div>
                                <div>
                                    <label class="block text-gray-500 dark:text-gray-400 mb-1 text-sm">Gender</label>
                                    <select t-if="state.isEditing" t-model="state.editForm.gender" class="w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-lg bg-white dark:bg-gray-700 text-gray-800 dark:text-gray-100 focus:ring-2 focus:ring-custom-blue focus:border-transparent">
                                        <option value="">Select Gender</option>
                                        <option value="Male">Male</option>
                                        <option value="Female">Female</option>
                                    </select>
                                    <p t-else="" class="text-gray-800 dark:text-gray-100 font-medium" t-esc="state.user.gender"/>
                                </div>
                                <div>
                                    <label class="block text-gray-500 dark:text-gray-400 mb-1 text-sm">Date of Birth</label>
                                    <input t-if="state.isEditing" t-model="state.editForm.dateOfBirth" type="date" class="w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-lg bg-white dark:bg-gray-700 text-gray-800 dark:text-gray-100 focus:ring-2 focus:ring-custom-blue focus:border-transparent" />
                                    <p t-else="" class="text-gray-800 dark:text-gray-100 font-medium" t-esc="state.user.dateOfBirth"/>
                                </div>
                                <div>
                                    <label class="block text-gray-500 dark:text-gray-400 mb-1 text-sm">Phone</label>
                                    <input t-if="state.isEditing" t-model="state.editForm.phone" type="tel" class="w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-lg bg-white dark:bg-gray-700 text-gray-800 dark:text-gray-100 focus:ring-2 focus:ring-custom-blue focus:border-transparent" />
                                    <p t-else="" class="text-gray-800 dark:text-gray-100 font-medium" t-esc="state.user.phone"/>
                                </div>
                                <div>
                                    <label class="block text-gray-500 dark:text-gray-400 mb-1 text-sm">Email</label>
                                    <input t-if="state.isEditing" t-model="state.editForm.email" type="email" class="w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-lg bg-white dark:bg-gray-700 text-gray-800 dark:text-gray-100 focus:ring-2 focus:ring-custom-blue focus:border-transparent" />
                                    <p t-else="" class="text-gray-800 dark:text-gray-100 font-medium" t-esc="state.user.email"/>
                                </div>
                                <div>
                                    <label class="block text-gray-500 dark:text-gray-400 mb-1 text-sm">Role</label>
                                    <p class="text-gray-800 dark:text-gray-100 font-medium" t-esc="state.user.role"/>
                                </div>
                                <div class="col-span-2">
                                    <label class="block text-gray-500 dark:text-gray-400 mb-1 text-sm">Address</label>
                                    <textarea t-if="state.isEditing" t-model="state.editForm.address" rows="3" class="w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-lg bg-white dark:bg-gray-700 text-gray-800 dark:text-gray-100 focus:ring-2 focus:ring-custom-blue focus:border-transparent"></textarea>
                                    <p t-else="" class="text-gray-800 dark:text-gray-100 font-medium" t-esc="state.user.address"/>
                                </div>
                            </div>
                        </div>

                        <!-- Emergency Contact -->
                        <div class="mb-8">
                            <h4 class="text-md font-semibold text-gray-800 dark:text-gray-100 mb-4">Emergency Contact</h4>
                            <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                                <div>
                                    <label class="block text-gray-500 dark:text-gray-400 mb-1 text-sm">Contact Name</label>
                                    <input t-if="state.isEditing" t-model="state.editForm.emergencyContactName" type="text" class="w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-lg bg-white dark:bg-gray-700 text-gray-800 dark:text-gray-100 focus:ring-2 focus:ring-custom-blue focus:border-transparent" />
                                    <p t-else="" class="text-gray-800 dark:text-gray-100 font-medium" t-esc="state.user.emergencyContactName"/>
                                </div>
                                <div>
                                    <label class="block text-gray-500 dark:text-gray-400 mb-1 text-sm">Contact Phone</label>
                                    <input t-if="state.isEditing" t-model="state.editForm.emergencyContactPhone" type="tel" class="w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-lg bg-white dark:bg-gray-700 text-gray-800 dark:text-gray-100 focus:ring-2 focus:ring-custom-blue focus:border-transparent" />
                                    <p t-else="" class="text-gray-800 dark:text-gray-100 font-medium" t-esc="state.user.emergencyContactPhone"/>
                                </div>
                                <div class="md:col-span-2">
                                    <label class="block text-gray-500 dark:text-gray-400 mb-1 text-sm">Relationship</label>
                                    <input t-if="state.isEditing" t-model="state.editForm.emergencyContactRelation" type="text" class="w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-lg bg-white dark:bg-gray-700 text-gray-800 dark:text-gray-100 focus:ring-2 focus:ring-custom-blue focus:border-transparent" />
                                    <p t-else="" class="text-gray-800 dark:text-gray-100 font-medium" t-esc="state.user.emergencyContactRelation"/>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Change Password Modal -->
        <div t-if="state.showPasswordModal" class="fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50">
            <div class="bg-white dark:bg-gray-800 rounded-lg shadow-lg w-full max-w-md mx-4">
                <div class="p-6">
                    <div class="flex justify-between items-center mb-4">
                        <h3 class="text-lg font-bold text-gray-800 dark:text-gray-100">Change Password</h3>
                        <button t-on-click="closePasswordModal" class="text-gray-400 hover:text-gray-600 dark:hover:text-gray-300">
                            <span class="material-icons">close</span>
                        </button>
                    </div>
                    
                    <div class="space-y-4">
                        <div>
                            <label class="block text-gray-500 dark:text-gray-400 mb-1 text-sm">Current Password</label>
                            <input t-model="state.passwordForm.currentPassword" type="password" class="w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-lg bg-white dark:bg-gray-700 text-gray-800 dark:text-gray-100 focus:ring-2 focus:ring-custom-blue focus:border-transparent" />
                        </div>
                        <div>
                            <label class="block text-gray-500 dark:text-gray-400 mb-1 text-sm">New Password</label>
                            <input t-model="state.passwordForm.newPassword" type="password" class="w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-lg bg-white dark:bg-gray-700 text-gray-800 dark:text-gray-100 focus:ring-2 focus:ring-custom-blue focus:border-transparent" />
                        </div>
                        <div>
                            <label class="block text-gray-500 dark:text-gray-400 mb-1 text-sm">Confirm New Password</label>
                            <input t-model="state.passwordForm.confirmPassword" type="password" class="w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-lg bg-white dark:bg-gray-700 text-gray-800 dark:text-gray-100 focus:ring-2 focus:ring-custom-blue focus:border-transparent" />
                        </div>
                    </div>
                    
                    <div class="flex justify-end space-x-3 mt-6">
                        <button t-on-click="closePasswordModal" class="px-4 py-2 text-gray-600 dark:text-gray-400 border border-gray-300 dark:border-gray-600 rounded-lg hover:bg-gray-50 dark:hover:bg-gray-700 transition duration-300">
                            Cancel
                        </button>
                        <button t-on-click="changePassword" class="px-4 py-2 bg-custom-blue hover:bg-blue-600 text-white rounded-lg font-medium transition duration-300">
                            Change Password
                        </button>
                    </div>
                </div>
            </div>
        </div>

        <!-- Success/Error Messages -->
        <div t-if="state.message" t-att-class="'fixed top-4 right-4 p-4 rounded-lg shadow-lg z-50 ' + (state.messageType === 'success' ? 'bg-green-100 dark:bg-green-900 text-green-800 dark:text-green-200' : 'bg-red-100 dark:bg-red-900 text-red-800 dark:text-red-200')">
            <div class="flex items-center space-x-2">
                <span class="material-icons text-sm" t-esc="state.messageType === 'success' ? 'check_circle' : 'error'"/>
                <span t-esc="state.message"/>
            </div>
        </div>
    </t>
</templates>
