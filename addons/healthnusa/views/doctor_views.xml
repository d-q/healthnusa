<?xml version="1.0" encoding="utf-8"?>
<odoo>
    <data>

        <!-- Doctor List View -->
        <record id="view_doctor_tree" model="ir.ui.view">
            <field name="name">healthnusa.doctor.list</field>
            <field name="model">hr.employee</field>
            <field name="arch" type="xml">
                <list string="Doctors" create="true" edit="true" delete="true">
                    <field name="doctor_code"/>
                    <field name="name"/>
                    <field name="specialty_id"/>
                    <field name="duty_status" widget="badge"/>
                    <field name="work_phone"/>
                    <field name="work_email"/>
                    <field name="mobile_phone"/>
                    <field name="department_id"/>
                    <field name="job_id"/>
                    <field name="age"/>
                    <field name="total_experience_years"/>
                    <field name="active_schedules"/>
                </list>
            </field>
        </record>

        <!-- Doctor Form View -->
        <record id="view_doctor_form" model="ir.ui.view">
            <field name="name">healthnusa.doctor.form</field>
            <field name="model">hr.employee</field>
            <field name="arch" type="xml">
                <form string="Doctor">
                    <header>
                        <button name="toggle_duty_status" type="object" string="Toggle Duty Status" class="btn-primary"/>
                        <field name="duty_status" widget="statusbar" statusbar_visible="on_duty,on_call,off_duty,leave"/>
                    </header>
                    <sheet>
                        <div class="oe_button_box" name="button_box">
                            <button name="action_view_schedules" type="object" class="oe_stat_button" icon="fa-calendar">
                                <field name="active_schedules" widget="statinfo" string="Schedules"/>
                            </button>
                            <button name="action_view_documents" type="object" class="oe_stat_button" icon="fa-files-o">
                                <div class="o_field_widget o_stat_info">
                                    <span class="o_stat_value">
                                        <field name="document_count" widget="count"/>
                                    </span>
                                    <span class="o_stat_text">Documents</span>
                                </div>
                            </button>
                            <button name="action_view_employee_profile" type="object" class="oe_stat_button" icon="fa-user">
                                <div class="o_field_widget o_stat_info">
                                    <span class="o_stat_text">Employee Profile</span>
                                </div>
                            </button>
                        </div>

                        <field name="image_1920" widget="image" class="oe_avatar" options="{'preview_image': 'image_128'}"/>

                        <div class="oe_title">
                            <h1>
                                <field name="name" placeholder="Doctor Name" required="1"/>
                            </h1>
                            <h3>
                                <field name="doctor_code" readonly="1"/>
                            </h3>
                        </div>

                        <group>
                            <group name="basic_info" string="Basic Information">
                                <field name="is_doctor" invisible="0"/>
                                <field name="specialty_id" required="1"/>
                                <field name="work_email" required="1"/>
                                <field name="work_phone"/>
                                <field name="mobile_phone"/>
                                <field name="gender"/>
                                <field name="birthday"/>
                                <field name="age" readonly="1"/>
                            </group>
                            <group name="professional_info" string="Professional Information">
                                <field name="str_number"/>
                                <field name="sip_number"/>
                                <field name="duty_status"/>
                                <field name="total_experience_years" readonly="1"/>
                                <field name="department_id"/>
                                <field name="job_id"/>
                                <field name="parent_id"/>
                            </group>
                        </group>

                        <group name="address" string="Home Address">
                            <field name="address_id" widget="hr_employee_many2one" context="{'show_address': 1}" options="{'always_reload': True, 'highlight_first_line': True}"/>
                        </group>

                        <group name="hr_info" string="HR Information">
                            <group>
                                <field name="employee_type"/>
                                <field name="company_id"/>
                                <field name="identification_id"/>
                                <field name="passport_id"/>
                            </group>
                            <group>
                                <field name="emergency_contact"/>
                                <field name="emergency_phone"/>
                                <field name="bank_account_id"/>
                                <field name="active"/>
                            </group>
                        </group>

                        <notebook>
                            <page name="education" string="Education">
                                <field name="education_ids">
                                    <list editable="bottom">
                                        <field name="degree"/>
                                        <field name="institution"/>
                                        <field name="field_of_study"/>
                                        <field name="start_year"/>
                                        <field name="graduation_year"/>
                                        <field name="gpa"/>
                                        <field name="duration_years" readonly="1"/>
                                    </list>
                                </field>
                            </page>

                            <page name="experience" string="Experience">
                                <field name="experience_ids">
                                    <list editable="bottom">
                                        <field name="position"/>
                                        <field name="institution"/>
                                        <field name="start_date"/>
                                        <field name="end_date"/>
                                        <field name="is_current"/>
                                        <field name="department"/>
                                        <field name="duration_display" readonly="1"/>
                                    </list>
                                </field>
                            </page>

                            <page name="schedule" string="Schedule">
                                <field name="schedule_ids">
                                    <list editable="bottom">
                                        <field name="day_of_week"/>
                                        <field name="start_time" widget="float_time"/>
                                        <field name="end_time" widget="float_time"/>
                                        <field name="duration_hours" readonly="1"/>
                                        <field name="active"/>
                                        <field name="notes"/>
                                    </list>
                                </field>
                            </page>

                            <page name="documents" string="Documents">
                                <field name="document_ids">
                                    <list>
                                        <field name="name"/>
                                        <field name="document_type"/>
                                        <field name="filename"/>
                                        <field name="file_size_display"/>
                                        <field name="issue_date"/>
                                        <field name="expiry_date"/>
                                        <field name="is_verified" widget="boolean_toggle"/>
                                        <field name="is_expired" widget="badge"/>
                                    </list>
                                </field>
                            </page>
                        </notebook>
                    </sheet>
                    <chatter/>
                </form>
            </field>
        </record>

        <!-- Doctor Kanban View -->
        <record id="view_doctor_kanban" model="ir.ui.view">
            <field name="name">healthnusa.doctor.kanban</field>
            <field name="model">hr.employee</field>
            <field name="arch" type="xml">
                <kanban>
                    <field name="id"/>
                    <field name="name"/>
                    <field name="doctor_code"/>
                    <field name="specialty_id"/>
                    <field name="duty_status"/>
                    <field name="work_phone"/>
                    <field name="work_email"/>
                    <field name="mobile_phone"/>
                    <field name="image_128"/>
                    <field name="age"/>
                    <field name="total_experience_years"/>
                    <field name="department_id"/>
                    <field name="job_id"/>
                    <templates>
                        <t t-name="kanban-box">
                            <div class="oe_kanban_card oe_kanban_global_click">
                                <div class="oe_kanban_content">
                                    <div class="o_kanban_image">
                                        <img t-att-src="kanban_image('hr.employee', 'image_128', record.id.raw_value)" alt="Doctor"/>
                                    </div>
                                    <div class="oe_kanban_details">
                                        <div class="o_kanban_record_top">
                                            <div class="o_kanban_record_headings">
                                                <strong class="o_kanban_record_title">
                                                    <field name="name"/>
                                                </strong>
                                                <small class="o_kanban_record_subtitle text-muted">
                                                    <field name="doctor_code"/>
                                                </small>
                                            </div>
                                        </div>
                                        <div class="o_kanban_record_body">
                                            <field name="specialty_id"/>
                                            <br/>
                                            <field name="department_id"/>
                                            <br/>
                                            <i class="fa fa-phone"/>
                                            <field name="work_phone"/>
                                            <br/>
                                            <i class="fa fa-mobile"/>
                                            <field name="mobile_phone"/>
                                            <br/>
                                            <i class="fa fa-envelope"/>
                                            <field name="work_email"/>
                                        </div>
                                        <div class="o_kanban_record_bottom">
                                            <div class="oe_kanban_bottom_left">
                                                <field name="duty_status" widget="label_selection" options="{'classes': {'on_duty': 'success', 'on_call': 'warning', 'off_duty': 'danger', 'leave': 'info'}}"/>
                                            </div>
                                            <div class="oe_kanban_bottom_right">
                                                <span class="text-muted">
                                                    <t t-esc="record.age.value"/>
 years, <t t-esc="record.total_experience_years.value"/>
 exp</span>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </t>
                    </templates>
                </kanban>
            </field>
        </record>

        <!-- Doctor Search View -->
        <record id="view_doctor_search" model="ir.ui.view">
            <field name="name">healthnusa.doctor.search</field>
            <field name="model">hr.employee</field>
            <field name="arch" type="xml">
                <search string="Search Doctors">
                    <field name="name" string="Doctor Name"/>
                    <field name="doctor_code"/>
                    <field name="specialty_id"/>
                    <field name="work_email"/>
                    <field name="work_phone"/>
                    <field name="mobile_phone"/>
                    <field name="str_number"/>
                    <field name="sip_number"/>
                    <field name="department_id"/>
                    <field name="job_id"/>
                    <field name="parent_id"/>

                    <filter name="on_duty" string="On Duty" domain="[('duty_status', '=', 'on_duty')]"/>
                    <filter name="on_call" string="On Call" domain="[('duty_status', '=', 'on_call')]"/>
                    <filter name="off_duty" string="Off Duty" domain="[('duty_status', '=', 'off_duty')]"/>
                    <filter name="on_leave" string="On Leave" domain="[('duty_status', '=', 'leave')]"/>

                    <separator/>
                    <filter name="male" string="Male" domain="[('gender', '=', 'male')]"/>
                    <filter name="female" string="Female" domain="[('gender', '=', 'female')]"/>

                    <separator/>
                    <filter name="has_schedule" string="Has Schedule" domain="[('schedule_ids', '!=', False)]"/>
                    <filter name="no_schedule" string="No Schedule" domain="[('schedule_ids', '=', False)]"/>
                    <filter name="has_active_schedule" string="Has Active Schedule" domain="[('schedule_ids.active', '=', True)]"/>

                    <separator/>
                    <filter name="has_str" string="Has STR Number" domain="[('str_number', '!=', False)]"/>
                    <filter name="has_sip" string="Has SIP Number" domain="[('sip_number', '!=', False)]"/>
                    <filter name="verified_documents" string="Has Verified Documents" domain="[('document_ids.is_verified', '=', True)]"/>

                    <separator/>
                    <filter name="active_employees" string="Active Employees" domain="[('active', '=', True)]"/>
                    <filter name="inactive_employees" string="Inactive Employees" domain="[('active', '=', False)]"/>

                    <group expand="0" string="Group By">
                        <filter name="group_specialty" string="Specialty" context="{'group_by': 'specialty_id'}"/>
                        <filter name="group_duty_status" string="Duty Status" context="{'group_by': 'duty_status'}"/>
                        <filter name="group_gender" string="Gender" context="{'group_by': 'gender'}"/>
                        <filter name="group_department" string="Department" context="{'group_by': 'department_id'}"/>
                        <filter name="group_job" string="Job Position" context="{'group_by': 'job_id'}"/>
                        <filter name="group_manager" string="Manager" context="{'group_by': 'parent_id'}"/>
                    </group>
                </search>
            </field>
        </record>

        <!-- Doctor Action -->
        <record id="action_doctor" model="ir.actions.act_window">
            <field name="name">Doctors</field>
            <field name="res_model">hr.employee</field>
            <field name="view_mode">kanban,list,form</field>
            <field name="domain">[('is_doctor', '=', True)]</field>
            <field name="context">{'default_is_doctor': True}</field>
            <field name="search_view_id" ref="view_doctor_search"/>
            <field name="help" type="html">
                <p class="o_view_nocontent_smiling_face">
                    Create your first doctor
                </p>
                <p>
                    Add doctors to your healthcare system and manage their profiles, schedules, and documents.
                </p>
            </field>
        </record>

        <!-- Doctor Action from HR Menu -->
        <record id="action_doctor_from_hr" model="ir.actions.act_window">
            <field name="name">Doctor Employees</field>
            <field name="res_model">hr.employee</field>
            <field name="view_mode">kanban,list,form</field>
            <field name="domain">[('is_doctor', '=', True), ('active', '=', True)]</field>
            <field name="context">{'default_is_doctor': True}</field>
            <field name="search_view_id" ref="view_doctor_search"/>
        </record>

    </data>
</odoo>